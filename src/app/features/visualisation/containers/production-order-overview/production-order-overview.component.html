<mat-card>
  <mat-card-header>
    <mat-card-title>Fertigungsaufträge</mat-card-title>
    <mat-card-subtitle>Hier können Sie die Fertigungsaufträge einsehen, welche innerhalb des ausgewählten Zeitraums
      liegen</mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>
    <div fxLayout="row" fxLayoutAlign="start center">
      <mat-form-field [ngStyle]="{'margin-right': '10px'}">
        <input name="start" matInput [matDatepicker]="startDatePicker" placeholder="Choose a start date" [(ngModel)]="startDate">
        <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #startDatePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field [ngStyle]="{'margin-right': '10px'}">
        <input name="end" matInput [matDatepicker]="endDatePicker" placeholder="Choose a end date" [(ngModel)]="endDate">
        <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #endDatePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field [ngStyle]="{'margin-right': '10px'}">
        <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
      </mat-form-field>
      <button mat-icon-button>
        <mat-icon>autorenew</mat-icon>
      </button>
      <button mat-raised-button color="accent" (click)="exportAsExcel()">Export Excel</button>
    </div>
    <esi-production-order-table [data]="data | async" [columns]="displayedColumns" [status]="status$ | async"
      [showAll]="showAll" [filter]="filter$ | async"></esi-production-order-table>
  </mat-card-content>
</mat-card>


<div #TABLE [ngStyle]="{'display': 'none'}">
  <table *ngIf="dataSource; else noData" mat-table [dataSource]="dataSource" class="mat-elevation-z8" #orderTable>

    <ng-container matColumnDef="CustomerOrderId">
      <th mat-header-cell *matHeaderCellDef> Kundenauftragsnummer </th>
      <td mat-cell *matCellDef="let element"> {{element.CustomerOrderId}} </td>
    </ng-container>
  
    <ng-container matColumnDef="OrderDate">
      <th mat-header-cell *matHeaderCellDef> Bestelldatum </th>
      <td mat-cell *matCellDef="let element"> {{element.OrderDate | date:'mediumDate'}} </td>
    </ng-container>
  
    <ng-container matColumnDef="DeliveryDate">
      <th mat-header-cell *matHeaderCellDef> Lieferdatum </th>
      <td mat-cell *matCellDef="let element"> {{element.DeliveryDate | date:'mediumDate'}} </td>
    </ng-container>
  
    <ng-container matColumnDef="Color">
      <th mat-header-cell *matHeaderCellDef> Farbe </th>
      <td mat-cell *matCellDef="let element"> {{element.Color}} </td>
    </ng-container>
  
    <ng-container matColumnDef="Amount">
      <th mat-header-cell *matHeaderCellDef> Menge </th>
      <td mat-cell *matCellDef="let element"> {{element.Amount}} </td>
    </ng-container>
  
    <ng-container matColumnDef="OrderItem">
      <th mat-header-cell *matHeaderCellDef> Positionsnummer </th>
      <td mat-cell *matCellDef="let element"> {{element.OrderItem}} </td>
    </ng-container>
  
    <ng-container matColumnDef="OrderPosition">
      <th mat-header-cell *matHeaderCellDef> Sortierungsnummer </th>
      <td mat-cell *matCellDef="let element"> {{element.OrderPosition}} </td>
    </ng-container>
  
    <ng-container matColumnDef="ProductionStatusId">
      <th mat-header-cell *matHeaderCellDef> Status </th>
      <td mat-cell *matCellDef="let element"> {{element.ProductionStatusId}}</td>
    </ng-container>
  
    <tr mat-header-row *matHeaderRowDef="['CustomerOrderId', 'OrderDate', 'DeliveryDate', 'Color', 'Amount', 'OrderItem', 'OrderPosition', 'ProductionStatusId'];"></tr>
    <tr mat-row *matRowDef="let row; columns: ['CustomerOrderId', 'OrderDate', 'DeliveryDate', 'Color', 'Amount', 'OrderItem', 'OrderPosition', 'ProductionStatusId'];"></tr>
  </table>
  
  <ng-template #noData>
    Keine Daten vorhanden...
  </ng-template>
  
</div>